import Security from './security';
import DNS from './dns';
import HTML from './html';
import SEO from './seo';
import WordPress from './wordpress';
import { Result } from './Test';

interface PentestResult {
  security: Result;
  dns: Result;
  html: Result;
  seo: Result;
  wordpress: Result;
}

class Pentest {
  public async run(url: string): Promise<PentestResult> {
    const general = new DNS();
    const security = new Security();
    const html = new HTML();
    const seo = new SEO();
    const wordPress = new WordPress();
    const generalResult = <Result> await general.run({ url });
    const securityResult = <Result> await security.run({ url });
    const htmlResult = <Result> await html.run({ url });
    const seoResult = <Result> await seo.run({ url });
    const wordPressResult = <Result> await wordPress.run({ url });

    return {
      security: securityResult,
      dns: generalResult,
      html: htmlResult,
      seo: seoResult,
      wordpress: wordPressResult,
    };
  }
}

export default Pentest;