import { Command } from 'commander';
import Factory from './common/Factory';
import Security from './security/Security';
import HTML from './html/HTML';
import CommandLine from './report/CommandLine';

const program = new Command();

program
  .usage('[options] <URL>')
  .version('2.0.0')
  .description(`
    Check your website ( or any other website ) for common vulnerabilities.
  `).action(async function(url) {
    const factory = new Factory();
    const security = new Security(factory);
    const html = new HTML(factory);

    const results = [
      await security.run(url),
      await html.run(url),
    ];

    const commandLine = new CommandLine();
    commandLine.write(results);
  });

program.parse(process.argv);
