import Test from '../Test';

/**
 * 
 * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection
 */
class XXSSProtection extends Test {
  protected request: RequestInterface;

  protected logger: LoggerInterface;

  constructor(request: RequestInterface, logger: LoggerInterface) {
    super();
    this.request = request;
    this.logger = logger;
  }

  async run(url: string): Promise<ResultInterface> {
    this.logger.info('Starting X-XSS-Protection test...');
    const result = await this.request.get(url);

    if (!result.response.headers.hasOwnProperty('x-xss-protection')) {
      return this.getResult('X-XSS-Protection', 'UNSUCCESSFUL');  
    }

    return this.getResult('X-XSS-Protection', 'SUCCESSFUL');
  }
}

export default XXSSProtection;
