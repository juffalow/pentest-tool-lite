// @flow
import Result, { TYPE_OK, TYPE_ERROR } from '../pentest/Result';

export default class XXSSProtection {
  request: Object;
  logger: Object;
  
  /**
   * 
   * @param {Object} request
   * @param {Object} logger
   */
  constructor(request: Object, logger: Object) {
    this.request = request;
    this.logger = logger;
  }

  /**
   * 
   * @param {string} url
   * @returns {Promise}
   */
  async execute(url: string): Promise<Object> {
    this.logger.verbose('Executing X-XSS-Protection test...');

    const result = await this.request.get(url);

    if (!result.response.headers.hasOwnProperty('x-xss-protection')) {
      return new Result(url, TYPE_ERROR, []);
    }
    return new Result(url, TYPE_OK, []);
  }
}