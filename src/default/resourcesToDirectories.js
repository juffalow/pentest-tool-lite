import winston from 'winston';

/*
 * Takes array of links pointing on resources ( js & images files )
 * Transforms each of these link on array of folders
 * E.g. :
 * https://juffalow.com/folder1/folder2/folder3/whatever ->
 * [
 *    https://juffalow.com/,
 *    https://juffalow.com/folder1/,
 *    https://juffalow.com/folder1/folder2/,
 *    https://juffalow.com/folder1/folder2/folder3/
 * ]
 */

const resourcesToDirectories = function(resources) {
  winston.verbose('Converting resources to directories...');

  const directories = {};

  resources.forEach((resource) => {
    let start = resource.indexOf('/', 9) + 1;
    while (start > 0) {
      if (!directories.hasOwnProperty(resource.substring(0, start))) {
        directories[resource.substring(0, start)] = true;
      }
      start = resource.indexOf('/', start) + 1;
    }
  });

  return Object.keys(directories);
};

export default resourcesToDirectories;
