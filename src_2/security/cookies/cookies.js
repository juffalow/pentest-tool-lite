/**
 *
 * @param {Object} http
 * @throws {Error}
 */
export default function(http) {
  if (http.response.headers.hasOwnProperty('set-cookie')) {
    const regx = new RegExp('.*(secure; HttpOnly)$', 'i');
    const cookies = http.response.headers['set-cookie'];
    if (typeof cookies === 'object') {
      const unsecure = cookies.filter((cookie) => {
        return !regx.test(cookie);
      });

      if (unsecure.length > 0) {
        return false;
      }
    }
  }
  return true;
};
