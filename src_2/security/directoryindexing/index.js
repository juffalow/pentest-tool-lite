import * as fetch from '../../functions/fetch.js';
import parseHtml from '../../functions/parseHtml.js';
import getResources from '../../functions/getResources.js';
import resourcesToDirectories from '../../functions/resourcesToDirectories.js';
import checkDirectoryIndexing from './directoryIndexing';

const multipleUrlsToSingleCheck = (urls) => {
  return Promise.all(urls.map((singleUrl) => {
    return checkUrl(singleUrl);
  }));
};

const checkUrl = (url) => {
  return Promise.resolve(url)
    .then(fetch.fetch)
    .then((http) => {
      return {
        url: url,
        result: checkDirectoryIndexing(http),
      };
    });
};

export default () => {
  return [ fetch.fetch, parseHtml, getResources, resourcesToDirectories, multipleUrlsToSingleCheck ];
};
